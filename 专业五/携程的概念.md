# 携程的概念


在Unity中，协程（Coroutine）是一种特殊的函数，用于实现异步操作和延时执行。协程允许你在代码中创建可以暂停和恢复执行的函数，以便处理复杂的逻辑和异步任务。
在Unity中使用协程需要以下几个关键概念：

1. IEnumerator：协程函数的返回类型通常是IEnumerator接口。这表示协程函数可以使用yield return语句来指示在某个点暂停执行，并在稍后的时间点继续执行。
2. StartCoroutine()：这是Unity中的一个方法，用于启动一个协程。你可以通过调用StartCoroutine()方法，并传入协程函数作为参数来启动协程的执行。
3. yield return：在协程函数中，使用yield return语句来指示协程在此处暂停执行。你可以使用不同的关键字来暂停执行，例如yield return null表示暂停一帧，yield return WaitForSeconds(time)表示暂停一定时间。

携程和unity的主程序是可以同时运行的,携程会在后台运行通常用来计时异步

下面是打开和关闭携程的方法
obsidian://open?vault=Notes&file=%E4%B8%93%E4%B8%9A%E4%BA%94%2F%E6%90%BA%E7%A8%8B%E4%B8%AD%E8%87%AA%E5%B8%A6%E7%9A%84%E6%96%B9%E6%B3%95
携程中yield 的用法
![[Pasted image 20231213231907.png]]
我们知道协程的底层运行是基于迭代器,但在调度中是这样执行的,当我们定义协程函数时.相当于我们在主逻辑中定义了一个函数,它的线程运行依旧是从上到下依次执行的,这看起来就像同步.但为什么说协程是异步呢,因为yield它暂停了协程函数,使得协程函数还没有执行完,又发送请求给调度器,由调度器分配到协程函数下面的逻辑中,再次开启这个协程时,又会继续执行yield下面的内容.

协程底层的迭代器,是一个代码块一个代码块进行迭代的

当我们使用yield return new WaitForSeconde(1);//协程等待一秒
在这个时候调度器会分配线程给主线程,这样在协程等待的过程中会先执行主逻辑,一秒后再恢复协程执行yield下面的内容


我们通常会把IO密集的操作写在协程中,比如说加载资源,等待请求
这是因为协程的异步实现原理是基于调度器,这也就意味着如果协程中的计算量特别大的画会影响主线程逻辑的生命周期函数. 所以我们通常不把CPU密集也就是需要大量运算的逻辑写在协程中